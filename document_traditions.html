<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.247">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Music Memes - 14&nbsp; Modeling document traditions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./pitches.html" rel="next">
<link href="./chapter09.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Modeling document traditions</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Music Memes</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Welcome</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Prelude</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./style.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Style</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python_primer.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">A Python primer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./randomness.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Randomness and order</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Foundations</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter03.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Unbiased transmission</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter04.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Unbiased mutation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./biased_mutation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Biased mutation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Modeling biases</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter05.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Biased transmission: direct bias</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter06.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Biased transmission: frequency-dependent indirect bias</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter07.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Biased transmission: influencer-based indirect bias</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter08.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Vertical and horizontal cultural transmission</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter09.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The multiple traits model</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Advanced topics</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./document_traditions.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Modeling document traditions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pitches.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The usage of pitches and intervals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./folk_tunes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Folk tune complexity</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./communities.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Music communities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./style_evolution.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Style evolution</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclusion.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Conclusion</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#context" id="toc-context" class="nav-link active" data-scroll-target="#context"><span class="toc-section-number">14.1</span>  Context</a></li>
  <li><a href="#data-and-coding" id="toc-data-and-coding" class="nav-link" data-scroll-target="#data-and-coding"><span class="toc-section-number">14.2</span>  Data and coding</a></li>
  <li><a href="#sequence-alignment" id="toc-sequence-alignment" class="nav-link" data-scroll-target="#sequence-alignment"><span class="toc-section-number">14.3</span>  Sequence alignment</a></li>
  <li><a href="#constructing-a-possible-lineage" id="toc-constructing-a-possible-lineage" class="nav-link" data-scroll-target="#constructing-a-possible-lineage"><span class="toc-section-number">14.4</span>  Constructing a possible lineage</a></li>
  <li><a href="#being-confident" id="toc-being-confident" class="nav-link" data-scroll-target="#being-confident"><span class="toc-section-number">14.5</span>  Being confident</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="toc-section-number">14.6</span>  Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Modeling document traditions</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Here, we show how one can use cultural evolution methods to model the histories of manuscripts. This is based on a phylogenetic analysis of a Prelude by Orlando Gibbons <span class="citation" data-cites="Windram2014_PhylogeneticAnalysisOrlando">(<a href="references.html#ref-Windram2014_PhylogeneticAnalysisOrlando" role="doc-biblioref">Windram et al., 2014</a>)</span>.</p>
<section id="context" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="context"><span class="header-section-number">14.1</span> Context</h2>
<p>Mutations create new traditions [TODO]</p>
</section>
<section id="data-and-coding" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="data-and-coding"><span class="header-section-number">14.2</span> Data and coding</h2>
<p>We use the same data as in <span class="citation" data-cites="Windram2014_PhylogeneticAnalysisOrlando">(<a href="references.html#ref-Windram2014_PhylogeneticAnalysisOrlando" role="doc-biblioref">Windram et al., 2014</a>)</span><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>This is a case of a qualitative encoding, because the features were manually chosen and encoded according to the expert’s opinion.</p>
<p>In the context of this chapter, we will rely on implementations of several algorithms in the <em>BioPython</em> library. We also implot <code>matplotlib</code> for visualization.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio <span class="im">import</span> SeqIO, AlignIO, Phylo</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> Bio.Phylo.TreeConstruction <span class="im">import</span> DistanceCalculator, DistanceTreeConstructor</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The data codings are stored in the file <code>gibbons_prelude.nex</code> in the <a href="https://en.wikipedia.org/wiki/Nexus_file">NEXUS format</a>. First, let’s have a look at the file’s contents:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">file</span> <span class="op">=</span> <span class="st">"data/gibbons_prelude.nex"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="bu">file</span>) <span class="im">as</span> f:</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> f.readlines():</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> line.rstrip(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>) <span class="co"># remove trailing line breaks</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(line[:<span class="dv">65</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#NEXUS
[! 01-Nov-2013 - with taxanames 07-Feb-2023]
BEGIN taxa;
    DIMENSIONS NTAX=16;
    TAXLABELS
    [1] Parthenia
    [2] Lcm2093
    [3] Och47
    [4] Och89
    [5] Lbl31403
    [6] NYp5612
    [7] Cfm653
    [8] Lbl22099
    [9] LynarA2
    [10] Lbl23623i
    [11] Lbl23623ii
    [12] PcRes1186bisI
    [13] LblMus1
    [14] TnN335
    [15] Dolmetsch
    [16] Filmer17
    
;
END;
BEGIN characters;
    dimensions nchar=610;
    format
        datatype=standard
        missing=?
        respectcase SYMBOLS="0123456789abcdefghijklmnopqrstuvwxyz";
    matrix
Parthenia       000000000000000000000000000000000000000?000000000
Lcm2093         110010100000000000000000000000000001000?000000011
Och47           00002110110011110110111?1010100010010010000000012
Och89           000031102001000000000000000020000011112?100000010
Lbl31403        220010?10000200000010000010120000002022?100000013
NYp5612         33000020110000000000000000000000001?000?0000000?0
Cfm653          22110011110011110210121111?031?01001022?00100??11
Lbl22099        401000113?11111102101211111041011001022?11?100013
LynarA2         000000211100000000000000000000000013000?000000023
Lbl23623i       540001?000101121100000000000000001100?2?001110001
Lbl23623ii      640001?01110111100000000000000000011002?001110011
PcRes1186bisI   200000110000112113000300000020000001022?100000011
LblMus1         2100001000011111011014001010500010010010000000011
TnN335          750100111100111104101511111031001001002?001000013
Dolmetsch       811000100001111100000000021061000001002?001000011
Filmer17        2110001000002000000000000000200000010011000000011
    ;
END;
</code></pre>
</div>
</div>
<p>The file’s structure is very clear. In the header, it declares its format (<code>#NEXUS</code>) along with some metadata, and then lists the 16 ‘taxa’ (the original <em>Parthenia</em> and its different copies). It further describes the encoding scheme, namely which <code>SYMBOLS</code> can be used (integers from 0-9 as well as lowercase roman letters), and that the <code>?</code> symbol will be used for missing data. We also can see that the dimensionality is <code>nchar=610</code>, meaning that the encoding emcompasses 610 different features.</p>
<p>Let’s read in the file using BioPython’s built-in parser and print the names of all manuscripts:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> manuscript <span class="kw">in</span> SeqIO.parse(<span class="bu">file</span>, <span class="bu">format</span><span class="op">=</span><span class="st">"nexus"</span>):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(manuscript.name) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parthenia
Lcm2093
Och47
Och89
Lbl31403
NYp5612
Cfm653
Lbl22099
LynarA2
Lbl23623i
Lbl23623ii
PcRes1186bisI
LblMus1
TnN335
Dolmetsch
Filmer17</code></pre>
</div>
</div>
</section>
<section id="sequence-alignment" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="sequence-alignment"><span class="header-section-number">14.3</span> Sequence alignment</h2>
<p>Each manuscript containing Gibbon’s Prelude is encoded as a string of characters (see above). In order to find deviations, mutations, and errors in the sequences, we will find best alignments of the manuscript encodings using BioPython. While the alignments here rely purely on visual and philological features of the text, this methodology has also been successfully applied to melodic variations <span class="citation" data-cites="Savage2022_SequenceAlignmentFolk">(<a href="references.html#ref-Savage2022_SequenceAlignmentFolk" role="doc-biblioref">Savage et al., 2022</a>)</span>.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>alignments <span class="op">=</span> <span class="bu">next</span>(AlignIO.parse(<span class="bu">file</span>, <span class="bu">format</span><span class="op">=</span><span class="st">"nexus"</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignments[:<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Alignment with 3 rows and 610 columns
[{'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['?']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}]...[{'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}] Parthenia
[{'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['?']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}]...[{'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['?']}, {'t': 'std', 'd': ['1']}] Lcm2093
[{'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['2']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['?']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['0']}]...[{'t': 'std', 'd': ['0']}, {'t': 'std', 'd': ['1']}, {'t': 'std', 'd': ['1']}] Och47</code></pre>
</div>
</div>
</section>
<section id="constructing-a-possible-lineage" class="level2" data-number="14.4">
<h2 data-number="14.4" class="anchored" data-anchor-id="constructing-a-possible-lineage"><span class="header-section-number">14.4</span> Constructing a possible lineage</h2>
<p>We are now in the position to create a possible hereditance system out of these alignments because we can use these closest alignments to determine pairwise distances between the sequences.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>calculator <span class="op">=</span> DistanceCalculator(model<span class="op">=</span><span class="st">"identity"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="op">=</span> calculator.get_distance(alignments)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>constructor <span class="op">=</span> DistanceTreeConstructor(calculator)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From this constructor, we can now build a tree:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> constructor.build_tree(alignments)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tree(rooted=False)
    Clade(branch_length=0, name='Inner14')
        Clade(branch_length=0.020120389344262246, name='Inner12')
            Clade(branch_length=0.08942964480874313, name='Inner7')
                Clade(branch_length=0.3522540983606557, name='Lbl31403')
                Clade(branch_length=0.12725409836065588, name='Inner2')
                    Clade(branch_length=0.2826292559899118, name='Filmer17')
                    Clade(branch_length=0.13868221941992426, name='Och89')
            Clade(branch_length=0.22552937158469957, name='Inner1')
                Clade(branch_length=0.10017564402810297, name='NYp5612')
                Clade(branch_length=0.09162763466042156, name='Parthenia')
        Clade(branch_length=0.005033299180327883, name='Inner13')
            Clade(branch_length=0.021810963114754167, name='Inner11')
                Clade(branch_length=0.11976178278688522, name='Inner6')
                    Clade(branch_length=0.287431693989071, name='LblMus1')
                    Clade(branch_length=0.23060109289617492, name='Lbl22099')
                Clade(branch_length=0.01732838114754097, name='Inner10')
                    Clade(branch_length=0.3853483606557378, name='Cfm653')
                    Clade(branch_length=0.13186475409836057, name='Inner4')
                        Clade(branch_length=0.18412816691505207, name='TnN335')
                        Clade(branch_length=0.2535767511177348, name='Och47')
            Clade(branch_length=0.03418288934426228, name='Inner9')
                Clade(branch_length=0.06726434426229502, name='Inner8')
                    Clade(branch_length=0.2635538641686183, name='PcRes1186bisI')
                    Clade(branch_length=0.26595433255269324, name='LynarA2')
                Clade(branch_length=0.19298155737704922, name='Inner3')
                    Clade(branch_length=0.23695355191256845, name='Dolmetsch')
                    Clade(branch_length=0.08763661202185774, name='Lcm2093')
        Clade(branch_length=0.13326075819672134, name='Inner5')
            Clade(branch_length=0.28704918032786886, name='Lbl23623ii')
            Clade(branch_length=0.18836065573770489, name='Lbl23623i')</code></pre>
</div>
</div>
<p>The Phylo library provides a convenient function to plot this tree:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> clade <span class="kw">in</span> tree.get_nonterminals():</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    clade.name <span class="op">=</span> <span class="st">""</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> Phylo.draw(tree)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="document_traditions_files/figure-html/cell-8-output-1.png" width="585" height="429"></p>
</div>
</div>
</section>
<section id="being-confident" class="level2" data-number="14.5">
<h2 data-number="14.5" class="anchored" data-anchor-id="being-confident"><span class="header-section-number">14.5</span> Being confident</h2>
<p>Use bootstrapping.</p>
</section>
<section id="conclusion" class="level2" data-number="14.6">
<h2 data-number="14.6" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">14.6</span> Conclusion</h2>
<p>Briefly discuss NeighborNet graph and point to similar approach in <span class="citation" data-cites="Windram2022_PhylogeneticAnalysisTwo">(<a href="references.html#ref-Windram2022_PhylogeneticAnalysisTwo" role="doc-biblioref">Windram et al., 2022</a>)</span>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="doc-bibliography" style="display: none">
<div id="ref-Savage2022_SequenceAlignmentFolk" class="csl-entry" role="doc-biblioentry">
Savage, P. E., Passmore, S., Chiba, G., Currie, T. E., Suzuki, H., &amp; Atkinson, Q. D. (2022). Sequence alignment of folk song melodies reveals cross-cultural regularities of musical evolution. <em>Current Biology</em>, <em>0</em>(0). <a href="https://doi.org/10.1016/j.cub.2022.01.039">https://doi.org/10.1016/j.cub.2022.01.039</a>
</div>
<div id="ref-Windram2014_PhylogeneticAnalysisOrlando" class="csl-entry" role="doc-biblioentry">
Windram, H. F., Charlston, T., &amp; Howe, C. J. (2014). A phylogenetic analysis of <span>Orlando Gibbons</span>’s <span>Prelude</span> in <span>G</span>. <em>Early Music</em>, <em>42</em>(4), 515–528. <a href="https://www.jstor.org/stable/43307114">https://www.jstor.org/stable/43307114</a>
</div>
<div id="ref-Windram2022_PhylogeneticAnalysisTwo" class="csl-entry" role="doc-biblioentry">
Windram, H. F., Charlston, T., Tomita, Y., &amp; Howe, C. J. (2022). A phylogenetic analysis of two preludes from <span>J</span>. <span>S</span>. <span>Bach</span>’s <span>Well-Tempered Clavier II</span>. <em>Early Music</em>, caac027. <a href="https://doi.org/10.1093/em/caac027">https://doi.org/10.1093/em/caac027</a>
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>I am grateful to Heather Windram for providing the data and to Francis Windram for helping me to parse it properly.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter09.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The multiple traits model</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./pitches.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">The usage of pitches and intervals</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2023, Fabian C. Moss</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/fabianmoss">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/fabianmoss">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>